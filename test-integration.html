<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Integration Test</title>
  <script type="module">
    // Test if all modules load correctly
    import { UIController } from './src/controllers/UIController.js';
    import { InteractionHandler } from './src/handlers/InteractionHandler.js';
    import { PathCalculatorWithWorker } from './src/services/PathCalculatorWithWorker.js';
    import { EventBus } from './src/core/EventBus.js';
    
    console.log('✅ All modules loaded successfully!');
    
    // Test event bus
    const eventBus = new EventBus();
    eventBus.on('test', (data) => console.log('Event received:', data));
    eventBus.emit('test', { message: '✅ EventBus working!' });
    
    // Test path calculator
    const pathCalc = new PathCalculatorWithWorker();
    console.log('✅ PathCalculatorWithWorker created!');
    
    // Test async path calculation
    const testWaypoints = [
      { x: 0, y: 0, isMajor: true },
      { x: 100, y: 100, isMajor: true },
      { x: 200, y: 50, isMajor: true }
    ];
    
    pathCalc.calculatePathAsync(testWaypoints)
      .then(path => {
        console.log('✅ Async path calculation successful!', 'Points:', path.length);
      })
      .catch(err => {
        console.log('⚠️ Async failed (expected), falling back to sync');
        const syncPath = pathCalc.calculatePath(testWaypoints);
        console.log('✅ Sync path calculation successful!', 'Points:', syncPath.length);
      });
    
    // Cleanup
    setTimeout(() => {
      pathCalc.destroy();
      console.log('✅ Cleanup complete!');
    }, 2000);
  </script>
</head>
<body>
  <h1>Integration Test</h1>
  <p>Check the console for test results.</p>
  <ul>
    <li>✅ Module loading</li>
    <li>✅ EventBus communication</li>
    <li>✅ Path calculation (async/sync)</li>
    <li>✅ Resource cleanup</li>
  </ul>
</body>
</html>
