<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Route Plotter v2.0</title>
    <meta name="description" content="Create animated route visualizations with waypoints, paths, and labels">
    <link rel="stylesheet" href="/src/styles/main.css">
  </head>
  <body>
    <div id="app">
      <!-- Splash Screen -->
      <div id="splash" class="splash-screen" role="dialog" aria-labelledby="splash-title">
        <div class="splash-content">
          <h1 id="splash-title">Welcome to Route Plotter v2.0</h1>
          <p>Create animated route visualizations in minutes - no timeline editing or keyframe jargon required!</p>
          
          <div class="getting-started">
            <h2>Getting Started:</h2>
            <ol>
              <li><strong>Upload an image:</strong> Drag and drop or click to upload your base image/map</li>
              <li><strong>Add waypoints:</strong> Click on the canvas to add major waypoints</li>
              <li><strong>Shape your path:</strong> Hold Shift+Click to add minor waypoints for curves</li>
              <li><strong>Customize:</strong> Use the controls to style your path and animation</li>
              <li><strong>Preview:</strong> Use the playback controls to preview your animation</li>
              <li><strong>Export:</strong> Save your project or export as video/HTML</li>
            </ol>
          </div>
          
          <div class="keyboard-shortcuts">
            <h3>Keyboard Shortcuts:</h3>
            <ul>
              <li><kbd>Space</kbd> - Play/Pause</li>
              <li><kbd>Arrow Keys</kbd> - Nudge selected waypoint</li>
              <li><kbd>Shift + Arrows</kbd> - Nudge waypoint faster</li>
              <li><kbd>J/K/L</kbd> - Backwards/Stop/Forward</li>
              <li><kbd>Esc</kbd> - Cancel current operation</li>
            </ul>
          </div>
          
          <button id="close-splash" class="btn btn-primary">Start Creating</button>
        </div>
      </div>

      <!-- Main Application -->
      <header class="app-header">
        <div class="header-left">
          <h1>Route Plotter v2.0</h1>
          <button id="help-btn" class="btn btn-secondary" aria-label="Show help">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
          </button>
        </div>
        <div class="header-center">
          <nav class="track-tabs" role="tablist">
            <button class="tab-btn active" role="tab" data-track="path" aria-selected="true">Path</button>
            <button class="tab-btn" role="tab" data-track="camera" aria-selected="false">Camera</button>
            <button class="tab-btn" role="tab" data-track="labels" aria-selected="false">Labels</button>
          </nav>
        </div>
        <div class="header-right">
          <button id="undo-btn" class="btn btn-icon" aria-label="Undo" disabled>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 7v6h6"></path>
              <path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"></path>
            </svg>
          </button>
          <button id="redo-btn" class="btn btn-icon" aria-label="Redo" disabled>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 7v6h-6"></path>
              <path d="M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7"></path>
            </svg>
          </button>
          <button id="save-btn" class="btn btn-primary">Save Project</button>
          <button id="export-btn" class="btn btn-primary">Export</button>
        </div>
      </header>

      <main class="app-main">
        <!-- Left Panel - Controls -->
        <aside class="left-panel">
          <div class="panel-section">
            <h2>Content</h2>
            <div class="image-upload-area" id="image-upload">
              <div class="upload-placeholder">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <circle cx="8.5" cy="8.5" r="1.5"></circle>
                  <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                <p>Drop image here or click to upload</p>
                <input type="file" id="image-input" accept="image/png,image/jpeg,image/jpg" hidden>
              </div>
            </div>
            <div class="form-group">
              <label for="alt-text">Alt Text (Required for export)</label>
              <textarea id="alt-text" rows="3" placeholder="Describe the image for accessibility..." aria-required="true"></textarea>
            </div>
          </div>

          <div class="panel-section" id="path-controls">
            <h2>Path Style</h2>
            <div class="form-group">
              <label for="stroke-color">Path Color</label>
              <input type="color" id="stroke-color" value="#FF6B6B">
            </div>
            <div class="form-group">
              <label for="stroke-width">Path Width</label>
              <input type="range" id="stroke-width" min="1" max="10" value="3">
              <span class="range-value">3px</span>
            </div>
            <div class="form-group">
              <label for="path-style">Path Style</label>
              <select id="path-style">
                <option value="solid">Solid Line</option>
                <option value="dashed">Dashed Line</option>
                <option value="dots">Dots</option>
                <option value="squiggle">Squiggle</option>
              </select>
            </div>
            <div class="form-group">
              <label for="waypoint-shape">Waypoint Shape</label>
              <select id="waypoint-shape">
                <option value="circle">Circle</option>
                <option value="square">Square</option>
                <option value="none">None</option>
              </select>
            </div>
            <div class="form-group">
              <label for="path-head">Path Head</label>
              <select id="path-head">
                <option value="arrow">Arrow</option>
                <option value="pulse-dot">Pulsing Dot</option>
                <option value="none">None</option>
                <option value="custom">Custom Image</option>
              </select>
            </div>
            <div class="form-group">
              <label for="waypoint-animation">Waypoint Animation</label>
              <select id="waypoint-animation">
                <option value="none">None</option>
                <option value="sonar">Sonar Ripple</option>
                <option value="ring">Expanding Ring</option>
              </select>
            </div>
          </div>

          <div class="panel-section">
            <h2>Timing</h2>
            <div class="form-group">
              <label for="timing-mode">Timing Mode</label>
              <select id="timing-mode">
                <option value="constant-time">Constant Time per Segment</option>
                <option value="constant-speed">Constant Speed</option>
              </select>
            </div>
            <div class="form-group">
              <label for="pause-mode">Pause at Waypoints</label>
              <select id="pause-mode">
                <option value="none">No Pause</option>
                <option value="seconds">Pause (seconds)</option>
                <option value="click">Wait for Click</option>
              </select>
            </div>
            <div class="form-group" id="pause-duration-group" style="display: none;">
              <label for="pause-duration">Pause Duration (seconds)</label>
              <input type="number" id="pause-duration" min="0.5" max="10" step="0.5" value="2">
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" id="ease-in-out" checked>
                Ease In/Out Animation
              </label>
            </div>
          </div>

          <div class="panel-section">
            <h2>View</h2>
            <div class="form-group">
              <label for="canvas-fit">Canvas Fit</label>
              <select id="canvas-fit">
                <option value="fit">Fit</option>
                <option value="fill">Fill</option>
                <option value="1:1">1:1</option>
              </select>
            </div>
            <div class="form-group">
              <label for="aspect-ratio">Aspect Ratio</label>
              <select id="aspect-ratio">
                <option value="16:9">16:9</option>
                <option value="4:3">4:3</option>
                <option value="1:1">1:1</option>
                <option value="native">Native</option>
              </select>
            </div>
            <div class="form-group">
              <label for="contrast-overlay">Contrast Overlay</label>
              <input type="range" id="contrast-overlay" min="-90" max="90" value="0">
              <span class="range-value">0%</span>
            </div>
          </div>

          <div class="panel-section">
            <h2>Color Palettes</h2>
            <div class="palette-buttons">
              <button class="palette-btn" data-palette="default">Default</button>
              <button class="palette-btn" data-palette="colorblind1">Colorblind Safe 1</button>
              <button class="palette-btn" data-palette="colorblind2">Colorblind Safe 2</button>
            </div>
          </div>
        </aside>

        <!-- Center - Canvas Area -->
        <div class="canvas-container">
          <div class="canvas-wrapper" id="canvas-wrapper">
            <canvas id="main-canvas" role="img" aria-label="Route animation canvas"></canvas>
            <div class="drop-overlay" id="drop-overlay" style="display: none;">
              <p>Drop image here</p>
            </div>
          </div>

          <!-- Playback Controls -->
          <div class="playback-controls">
            <button id="play-btn" class="btn btn-icon" aria-label="Play/Pause">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
              </svg>
            </button>
            <button id="start-btn" class="btn btn-icon" aria-label="Go to start">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <polygon points="19 20 9 12 19 4 19 20"></polygon>
                <line x1="5" y1="19" x2="5" y2="5" stroke="currentColor" stroke-width="2"></line>
              </svg>
            </button>
            <button id="end-btn" class="btn btn-icon" aria-label="Go to end">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <polygon points="5 4 15 12 5 20 5 4"></polygon>
                <line x1="19" y1="5" x2="19" y2="19" stroke="currentColor" stroke-width="2"></line>
              </svg>
            </button>
            <div class="timeline-container">
              <input type="range" id="timeline-scrubber" min="0" max="1000" value="0" aria-label="Timeline scrubber">
              <div class="timeline-time">
                <span id="current-time">0:00</span> / <span id="total-time">0:00</span>
              </div>
            </div>
            <div class="speed-controls">
              <button id="speed-down" class="btn btn-icon" aria-label="Decrease speed">0.5x</button>
              <span id="speed-display">1x</span>
              <button id="speed-up" class="btn btn-icon" aria-label="Increase speed">2x</button>
            </div>
          </div>
        </div>

        <!-- Right Panel - Waypoints -->
        <aside class="right-panel">
          <div class="panel-section">
            <h2>Waypoints</h2>
            <div class="waypoint-instructions">
              <p><strong>Click</strong> canvas to add major waypoint</p>
              <p><strong>Shift+Click</strong> to add minor waypoint</p>
              <p><strong>Drag</strong> waypoint to move</p>
            </div>
            <div class="waypoint-list" id="waypoint-list">
              <div class="empty-state">No waypoints yet</div>
            </div>
          </div>
        </aside>
      </main>

      <!-- Export Modal -->
      <div id="export-modal" class="modal" style="display: none;" role="dialog" aria-labelledby="export-title">
        <div class="modal-content">
          <h2 id="export-title">Export Options</h2>
          <div class="export-options">
            <button class="export-option" data-export="webm">
              <h3>Export as Video (WebM)</h3>
              <p>25fps video file for use in presentations or video editing</p>
            </button>
            <button class="export-option" data-export="html">
              <h3>Export as Standalone HTML</h3>
              <p>Self-contained HTML file with embedded animation</p>
            </button>
            <button class="export-option" data-export="embed">
              <h3>Get Embed Code</h3>
              <p>HTML snippet to embed animation in your website</p>
            </button>
            <button class="export-option" data-export="png-sequence">
              <h3>Export as PNG Sequence</h3>
              <p>Individual frames for video editing software</p>
            </button>
          </div>
          <button class="modal-close">Cancel</button>
        </div>
      </div>
    </div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
